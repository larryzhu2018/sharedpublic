Status: Succeeded
Test Event Name: (unsaved) test event

Response:
{
  "statusCode": 500,
  "headers": {
    "Content-Type": "application/json"
  },
  "body": "{\"error\":\"Request failed with status code 401\",\"requestId\":\"b049cc01-34f5-4a12-8108-c0e27ff01609\"}"
}

Function Logs:
rs\": {\n    \"host\": \"sts.amazonaws.com\",\n    \"x-goog-cloud-target-resource\": \"//iam.googleapis.com/projects/1052548303871/locations/global/workloadIdentityPools/aws-stg-east-identity-pool/providers/canvas-server-gcp\"\n  }\n}"}
2025-03-20T19:12:53.308Z	b049cc01-34f5-4a12-8108-c0e27ff01609	INFO	{"timestamp":"2025-03-20T19:12:53.308Z","message":"Signing AWS request"}
2025-03-20T19:12:53.444Z	b049cc01-34f5-4a12-8108-c0e27ff01609	INFO	{"timestamp":"2025-03-20T19:12:53.444Z","message":"Request signed successfully"}
2025-03-20T19:12:53.444Z	b049cc01-34f5-4a12-8108-c0e27ff01609	INFO	{"timestamp":"2025-03-20T19:12:53.444Z","message":"Token created successfully","data":"{\n  \"token\": {\n    \"url\": \"https://sts.amazonaws.com/?Action=GetCallerIdentity&Version=2011-06-15\",\n    \"method\": \"POST\",\n    \"headers\": [\n      {\n        \"key\": \"Host\",\n        \"value\": \"sts.amazonaws.com\"\n      },\n      {\n        \"key\": \"X-Amz-Date\",\n        \"value\": \"20250320T191253Z\"\n      },\n      {\n        \"key\": \"X-Amz-Security-Token\",\n        \"value\": \"[REDACTED]\"\n      },\n      {\n        \"key\": \"X-Goog-Cloud-Target-Resource\",\n        \"value\": \"//iam.googleapis.com/projects/1052548303871/locations/global/workloadIdentityPools/aws-stg-east-identity-pool/providers/canvas-server-gcp\"\n      },\n      {\n        \"key\": \"Authorization\",\n        \"value\": \"[REDACTED]\"\n      }\n    ]\n  }\n}"}
2025-03-20T19:12:53.444Z	b049cc01-34f5-4a12-8108-c0e27ff01609	INFO	{"timestamp":"2025-03-20T19:12:53.444Z","message":"AWS token generated successfully"}
2025-03-20T19:12:53.444Z	b049cc01-34f5-4a12-8108-c0e27ff01609	INFO	{"timestamp":"2025-03-20T19:12:53.444Z","message":"Exchanging AWS credentials for Google federated token"}
2025-03-20T19:12:53.445Z	b049cc01-34f5-4a12-8108-c0e27ff01609	INFO	{"timestamp":"2025-03-20T19:12:53.445Z","message":"Making STS exchange request","data":"{\n  \"url\": \"https://sts.googleapis.com/v1/token\",\n  \"payload\": {\n    \"audience\": \"//iam.googleapis.com/projects/1052548303871/locations/global/workloadIdentityPools/aws-stg-east-identity-pool/providers/canvas-server-gcp\",\n    \"grantType\": \"urn:ietf:params:oauth:grant-type:token-exchange\",\n    \"requestedTokenType\": \"urn:ietf:params:oauth:token-type:access_token\",\n    \"scope\": \"https://www.googleapis.com/auth/cloud-platform\",\n    \"subjectTokenType\": \"urn:ietf:params:aws:token-type:aws4_request\",\n    \"subjectToken\": \"[REDACTED]\"\n  }\n}"}
2025-03-20T19:12:53.607Z	b049cc01-34f5-4a12-8108-c0e27ff01609	INFO	{"timestamp":"2025-03-20T19:12:53.607Z","message":"Successfully obtained federated token"}
2025-03-20T19:12:53.607Z	b049cc01-34f5-4a12-8108-c0e27ff01609	INFO	{"timestamp":"2025-03-20T19:12:53.607Z","message":"Impersonating service account","data":"{\n  \"serviceAccount\": \"canvas-server@gcp-5319e002.iam.gserviceaccount.com\",\n  \"impersonationUrl\": \"https://iamcredentials.googleapis.com/v1/projects/-/serviceAccounts/canvas-server@gcp-5319e002.iam.gserviceaccount.com\"\n}"}
2025-03-20T19:12:53.864Z	b049cc01-34f5-4a12-8108-c0e27ff01609	INFO	{"timestamp":"2025-03-20T19:12:53.864Z","message":"Successfully obtained impersonated ID token","data":"{}"}
2025-03-20T19:12:53.864Z	b049cc01-34f5-4a12-8108-c0e27ff01609	INFO	{"timestamp":"2025-03-20T19:12:53.864Z","message":"Successfully obtained Google Id token"}
2025-03-20T19:12:53.864Z	b049cc01-34f5-4a12-8108-c0e27ff01609	INFO	{"timestamp":"2025-03-20T19:12:53.864Z","message":"Calling Cloud Run endpoint","data":"{\n  \"url\": \"https://canvas-snapshot-processor-function-1052548303871.us-east4.run.app/process\",\n  \"method\": \"POST\"\n}"}
2025-03-20T19:12:54.184Z	b049cc01-34f5-4a12-8108-c0e27ff01609	ERROR	{"timestamp":"2025-03-20T19:12:54.184Z","message":"Lambda function failed","data":"Request failed with status code 401"}
END RequestId: b049cc01-34f5-4a12-8108-c0e27ff01609
REPORT RequestId: b049cc01-34f5-4a12-8108-c0e27ff01609	Duration: 2176.35 ms	Billed Duration: 2177 ms	Memory Size: 128 MB	Max Memory Used: 104 MB	Init Duration: 683.05 ms

Request ID: b049cc01-34f5-4a12-8108-c0e27ff01609